# Инструкция по проверке обработки ошибок

## Быстрая проверка

### 1. Откройте тестовую страницу

Перейдите по адресу: `http://ваш-домен/test_errors.html`

На странице есть кнопки для тестирования всех функций обработки ошибок.

### 2. Проверка уведомлений

1. Нажмите кнопки "Показать ошибку", "Показать предупреждение" и т.д.
2. **Ожидаемый результат:** В правом верхнем углу должны появляться цветные уведомления с плавной анимацией

### 3. Проверка сетевых ошибок

1. Нажмите "Симулировать сетевую ошибку"
2. **Ожидаемый результат:** Должно появиться понятное сообщение об ошибке сети

### 4. Проверка реальных запросов

1. Нажмите "Запрос к несуществующему эндпоинту"
2. **Ожидаемый результат:** Должно появиться уведомление об ошибке

## Ручная проверка в корзине

### 1. Проверка обработки ошибок при отправке заказа

1. Откройте страницу корзины: `/cart.html`
2. Добавьте товары в корзину
3. Заполните форму заказа
4. **Отключите интернет** (или заблокируйте запросы через DevTools)
5. Нажмите "Оформить заказ"
6. **Ожидаемый результат:** 
   - Должно появиться уведомление об ошибке сети
   - В консоли должен быть лог ошибки
   - Кнопка должна вернуться в исходное состояние

### 2. Проверка обработки ошибок сервера

1. Откройте корзину
2. Заполните форму
3. В DevTools → Network → Offline (или заблокируйте домен)
4. Отправьте заказ
5. **Ожидаемый результат:** Понятное сообщение об ошибке

### 3. Проверка обработки rate limiting

1. Откройте корзину
2. Быстро отправьте несколько заказов подряд (3+)
3. **Ожидаемый результат:** 
   - Должно появиться предупреждение о слишком частых запросах
   - Указано время ожидания

## Проверка через консоль браузера

### 1. Откройте консоль (F12)

### 2. Проверьте наличие функций

Выполните в консоли:

```javascript
// Проверка функций
console.log('showNotification:', typeof showNotification);
console.log('handleFetchError:', typeof handleFetchError);
console.log('safeJsonParse:', typeof safeJsonParse);
```

**Ожидаемый результат:** Все три функции должны быть `function`

### 3. Тест уведомлений

```javascript
// Тест уведомления об ошибке
showNotification('Тестовое сообщение об ошибке', 'error');

// Тест уведомления об успехе
showNotification('Операция выполнена успешно!', 'success');
```

**Ожидаемый результат:** Должны появиться уведомления

### 4. Тест обработки сетевых ошибок

```javascript
// Симуляция сетевой ошибки
const error = new TypeError('Failed to fetch');
error.name = 'NetworkError';
const message = handleFetchError(error);
console.log('Сообщение:', message);
showNotification(message, 'error');
```

**Ожидаемый результат:** Понятное сообщение об ошибке сети

## Проверка логов ошибок

### 1. Откройте консоль браузера (F12)

### 2. Проверьте логирование

При возникновении ошибок в консоли должны быть логи вида:

```
[Yandex Metrika] Не удалось отправить цель: ...
[Calltouch] Ошибка отправки данных: ...
Ошибка отправки заказа: ...
```

**Ожидаемый результат:** Все ошибки логируются с понятными сообщениями

## Проверка в продакшене

### 1. Проверка реальных сценариев

1. **Отключение интернета:**
   - Откройте корзину
   - Отключите интернет
   - Попробуйте отправить заказ
   - Должно появиться уведомление об ошибке сети

2. **Ошибка сервера:**
   - Если сервер вернет 500 ошибку
   - Должно появиться понятное сообщение

3. **Таймаут:**
   - При медленном интернете
   - Должно появиться сообщение о проблеме с подключением

## Что должно работать

✅ **Уведомления:**
- Появляются в правом верхнем углу
- Имеют правильные цвета (красный для ошибок, зеленый для успеха)
- Автоматически исчезают через 5 секунд
- Имеют плавную анимацию

✅ **Обработка ошибок:**
- Сетевые ошибки обрабатываются корректно
- Показываются понятные сообщения пользователю
- Все ошибки логируются в консоль

✅ **Безопасность:**
- Нет пустых catch блоков
- Все ошибки обрабатываются
- JSON парсится безопасно

## Проблемы?

Если что-то не работает:

1. **Проверьте, что `utils.js` загружен:**
   - Откройте Network в DevTools
   - Найдите `utils.js`
   - Убедитесь, что он загружен (статус 200)

2. **Проверьте консоль на ошибки:**
   - Могут быть ошибки загрузки скриптов
   - Могут быть конфликты с другими скриптами

3. **Проверьте порядок загрузки:**
   - `utils.js` должен загружаться до `cart.js`
   - Проверьте порядок в HTML
