<!DOCTYPE html>
<html lang="ru" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Админ-панель</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/assets/icons/favicon/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/assets/icons/favicon/favicon.svg" />
  <link rel="shortcut icon" href="/assets/icons/favicon/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/favicon/apple-touch-icon.png" />
  <link rel="manifest" href="/assets/icons/favicon/site.webmanifest" />

  <!-- Tailwind CSS + DaisyUI (без Heroicons!) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@latest/dist/full.min.css" rel="stylesheet" />
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {}
      }
    }
  </script>
</head>
<body class="bg-base-100 text-base-content min-h-screen">
  <div class="flex min-h-screen flex-col">
    <!-- Header -->
    <header class="bg-base-200 px-6 py-4 flex justify-between items-center shadow">
      <h1 class="text-xl font-bold">Админ-панель</h1>
      <button id="logout-btn" class="btn btn-error btn-sm">Выйти</button>
    </header>

    <!-- Navigation -->
    <nav class="bg-base-200 px-6 py-2 border-b border-base-300">
      <div class="flex flex-wrap gap-2">
        <button class="tab tab-lifted tab-active" data-tab="products">Товары</button>
        <button class="tab tab-lifted" data-tab="attractions">Аттракционы</button>
        <button class="tab tab-lifted" data-tab="categories">Категории</button>
        <button class="tab tab-lifted" data-tab="orders">Заказы</button>
        <button class="tab tab-lifted" data-tab="supplier-catalog">Каталог для заказа</button>
      </div>
    </nav>
        <main class="admin-main">
            <!-- Вкладка Товары -->
            <section id="products-tab" class="tab-content active">
                <div class="tab-header">
                    <h2>Управление товарами</h2>
                    <button id="add-product-btn" class="btn-primary">Добавить товар</button>
                </div>
                <div id="admin-products-grid" class="admin-grid">
                    <!-- Товары будут подгружаться сюда -->
                </div>
            </section>
            <!-- Новая вкладка Аттракционы -->
            <section id="attractions-tab" class="tab-content">
                <div class="tab-header">
                    <h2>Управление аттракционами</h2>
                    <button id="add-attraction-btn" class="btn-primary">Добавить аттракцион</button>
                </div>
                <div id="admin-attractions-grid" class="admin-grid">
                    <!-- Аттракционы будут подгружаться сюда -->
                    <div class="empty">Загрузка аттракционов...</div>
                </div>
            </section>

            <!-- Вкладка Категории -->
            <section id="categories-tab" class="tab-content">
                <div class="tab-header">
                    <h2>Управление категориями</h2>
                    <button id="add-category-btn" class="btn-primary">Добавить категорию</button>
                </div>
                <div id="categories-list" class="admin-list">
                    <!-- Категории будут подгружаться сюда -->
                </div>
            </section>

            <!-- Вкладка Заказы -->
            <section id="orders-tab" class="tab-content">
                <h2>Заказы</h2>
                <div id="orders-list" class="admin-list">
                    <!-- Заказы будут подгружаться сюда -->
                </div>
            </section>
            <section id="supplier-catalog-tab" class="tab-content">
        <div class="tab-header">
            <h2>Каталог для заказа у поставщика</h2>
            <div>
                <input type="text" id="supplier-catalog-search" placeholder="Поиск по названию или ссылке..." class="search-input">
            </div>
        </div>
        <div id="supplier-catalog-grid" class="admin-grid">
            <!-- Товары будут подгружаться сюда -->
            <div class="empty">Загрузка товаров...</div>
        </div>
    </section>
        </main>
    </div>

    <!-- Модальное окно для товара -->
<div id="product-modal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2 id="modal-title">Добавить товар</h2>
        <form id="product-form"> 
            <input type="hidden" id="product-id" name="product-id">
            
            <label for="product-title">Название:</label>
            <input type="text" id="product-title" name="product-title" required> 

            <label for="product-description">Описание:</label>
            <textarea id="product-description" name="product-description"></textarea> 

            <label for="product-price">Цена (руб.):</label>
            <input type="number" id="product-price" name="product-price" step="0.01" required> 

            <label for="product-supplier-link">Ссылка на поставщика:</label>
 <input type="text" id="product-supplier-link" name="product-supplier-link">

 <label for="product-supplier-notes">Примечание к ссылке:</label>
 <input type="text" id="product-supplier-notes" name="product-supplier-notes">

            <label for="product-category">Категория:</label>
            <select id="product-category" name="product-category" required> 
                <!-- Опции будут загружены динамически -->
            </select>

            <!-- Управление изображениями -->
            <div class="images-section">
                <h3>Изображения товара</h3>
                <div id="images-drop-zone" class="images-drop-zone">
                    <div id="images-container" class="images-grid">
                        <!-- Изображения будут добавлены сюда динамически -->
                    </div>
                    <div id="drop-hint" class="drop-hint">
                        <p>Перетащите изображения сюда или нажмите "Добавить изображение"</p>
                    </div>
                </div>
                <button type="button" id="add-image-btn" class="btn-secondary">Добавить изображение</button>
            </div>

            <label>
                <input type="checkbox" id="product-available" name="product-available" checked> Доступен
            </label>

            <!-- Новый раздел: Варианты товара -->
            <div class="variants-section">
                <h3>Варианты товара</h3>
                <p class="hint">Выберите товары, которые являются вариантами этого товара (например, разные цвета или объемы).</p>
                
                <!-- Список выбранных вариантов -->
                <div id="selected-variants-list" class="selected-variants-list">
                    <!-- Выбранные варианты будут отображаться здесь -->
                </div>

                <!-- Поле поиска для добавления вариантов -->
                <div class="variant-search-container">
                    <input type="text" id="variant-search" placeholder="Поиск товаров для добавления как варианты..." autocomplete="off">
                    <div id="variant-search-results" class="variant-search-results hidden">
                        <!-- Результаты поиска будут отображаться здесь -->
                    </div>
                </div>
                <!-- Скрытое поле для хранения ID выбранных вариантов -->
                <input type="hidden" id="selected-variant-ids" name="selected-variant-ids">
            </div>

            <div class="modal-actions">
                <button type="button" id="cancel-btn" class="btn-secondary">Отмена</button>
                <button type="submit" class="btn-primary">Сохранить</button>
            </div>
        </form>
    </div>
</div>
<!-- Модальное окно для аттракциона -->
<div id="attraction-modal" class="modal">
    <div class="modal-content">
        <span class="close-attraction-modal close">&times;</span>
        <h2 id="attraction-modal-title">Добавить аттракцион</h2>
        <form id="attraction-form">
            <input type="hidden" id="attraction-id" name="attraction-id">

            <label for="attraction-title">Название:</label>
            <input type="text" id="attraction-title" name="attraction-title" required>

            <label for="attraction-description">Описание:</label>
            <textarea id="attraction-description" name="attraction-description" required></textarea>

            <label for="attraction-price">Цена (руб.):</label>
            <input type="number" id="attraction-price" name="attraction-price" step="0.01" required>

            <label for="attraction-category">Категория:</label>
            <input type="text" id="attraction-category" name="attraction-category" list="attraction-categories" required>
            <datalist id="attraction-categories">
                <!-- Опции будут загружены динамически -->
            </datalist>

            <!-- НОВОЕ: Поле для произвольных характеристик -->
            <div class="form-group">
                <label for="attraction-specs">Характеристики (JSON):</label>
                <textarea id="attraction-specs" name="attraction-specs" rows="4" placeholder='{"places": "1", "power": "500W", "custom_field": "value"}'></textarea>
            </div>

            <!-- Управление изображениями (ИСПРАВЛЕННЫЕ ID) -->
            <div class="images-section">
                <h3>Изображения аттракциона</h3>
                <div id="attraction-images-drop-zone" class="images-drop-zone"> <!-- ИЗМЕНЕН ID -->
                    <div id="attraction-images-container" class="images-grid"> <!-- ИЗМЕНЕН ID -->
                        <!-- Изображения будут добавлены сюда динамически -->
                    </div>
                    <div id="attraction-drop-hint" class="drop-hint show"> <!-- ИЗМЕНЕН ID -->
                        <p>Перетащите изображения сюда или нажмите "Добавить изображение"</p>
                    </div>
                </div>
                <button type="button" id="add-attraction-image-btn" class="btn-secondary">Добавить изображение</button> <!-- ИЗМЕНЕН ID -->
            </div>

            <!-- НОВОЕ: Управление видео -->
            <div class="form-group">
                <h3>Видео аттракциона</h3>
                <div id="attraction-videos-container" class="videos-container">
                    <!-- Здесь будут добавляться поля для видео -->
                </div>
                <button type="button" id="add-attraction-video-btn" class="btn-secondary">Добавить видео</button>
            </div>

            <label>
                <input type="checkbox" id="attraction-available" name="attraction-available" checked> Доступен
            </label>

            <div class="modal-actions">
                <button type="button" id="cancel-attraction-btn" class="btn-secondary">Отмена</button>
                <button type="submit" class="btn-primary">Сохранить</button>
            </div>
        </form>
    </div>
</div>
    <!-- Модальное окно для категории -->
    <div id="category-modal" class="modal">
        <div class="modal-content">
            <span class="close-category-modal close">&times;</span>
            <h2>Добавить категорию</h2>
            <form id="category-form">
                <label for="category-name">Название категории:</label>
                <input type="text" id="category-name" required>
                <div class="modal-actions">
                    <button type="button" id="cancel-category-btn" class="btn-secondary">Отмена</button>
                    <button type="submit" class="btn-primary">Добавить</button>
                </div>
            </form>
        </div>
    </div>
    <!-- Убедитесь, что admin-core.js подключен первым -->
<script src="js/admin/admin-core.js"></script>
<!-- Затем подключите остальные модули -->
<script src="js/admin/admin-products.js"></script>
<script src="js/admin/admin-attractions.js"></script>
<script src="js/admin/admin-categories.js"></script>
<script src="js/admin/admin-orders.js"></script>
<script src="js/admin/admin-supplier-catalog.js"></script>

 <!-- Cookie Consent Banner -->
<div id="cookieConsent" class="cookie-consent-banner">
  <div class="cookie-consent-content">
    <div class="cookie-consent-text">
      <p>Мы используем файлы cookie и аналогичные технологии для улучшения работы сайта, анализа трафика и персонализации контента. Продолжая использовать наш сайт, вы соглашаетесь с <a href="/privacy" target="_blank">Политикой конфиденциальности</a> и <a href="/cookie-policy" target="_blank">Политикой использования файлов cookie</a>.</p>
    </div>
    <div class="cookie-consent-buttons">
      <button id="acceptCookies" class="btn-primary">Принимаю</button>
      <button id="declineCookies" class="btn-secondary">Отклонить</button>
    </div>
  </div>
</div>
</body>
</html>